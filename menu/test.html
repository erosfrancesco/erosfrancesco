<head>
  	<title> Engine Headers </title>
</head>

<body>

    <style>
    
    #parent {
        display: table;
        margin: auto auto;
    }
  
    </style>
    <div id="parent"></div>

    <script src='../engine/phaser3.min.js'></script>
	<script src='../engine/colors.js'></script>
    <script src="../engine/Input.js"></script>



    <script>

        _TextStylingGradient = (that) => {
            that._text = that.scene.add.text(0, 0, "- phaser gradient text -")
            .setStyle({ align: 'center' })
            .setFontFamily('Arial')
            .setFontSize(32)
            .setFontStyle('bold')
            .setShadow(1, 2, "#333333", 2);

            //  Here we create a linear gradient on the Text context.
            //  This uses the exact same method of creating a gradient as you do on a normal Canvas context.
            let grd = that._text.context.createLinearGradient(0, 0, 0, that._text.height);
            grd.addColorStop(0, '#8ED6FF');   
            grd.addColorStop(1, '#004CB3');
            that._text.setColor(grd);

            that.selected    = () => { that._text.setColor("#EACA2F"); };
            that.notSelected = () => { that._text.setColor("#D2D2D2"); };
        };


        _TextStylingDefault = (that) => {
            
            that._text = that.scene.add.text(0, 0, "- phaser gradient text -")
            .setStyle({ align: 'center' })
            .setFontFamily('Arial')
            .setFontSize(32)
            .setFontStyle('bold')
            .setShadow(1, 2, "#333333", 2)
            .setColor('#D2D2D2');

            that.selected    = () => { that._text.setColor("#EACA2F"); };
            that.notSelected = () => { that._text.setColor("#D2D2D2"); };
        }



        class MenuItem {
            constructor(options) {

                // options decostruction
                let {
                    width, height,
                    x, y,
                    scene,
                    style,
                    text,
                    onSelect
                } = options;

                // options sanitization
                if (!scene) { return; }

                width  = width  || 100;
                height = height || 100;
                x = x || 0;
                y = y || 0;
                style = style || 'default';
                onSelect = onSelect || function() {};

                this._availableStyling = {
                    'default': _TextStylingDefault
                };

                // Properties
                this._DOM = {};
                this.x = x;
                this.y = y;
                this.text = text;
                this.width  = width;
                this.height = height;
                this.scene = scene;
                this.style = style;
                this.onSelect = onSelect;
                this._sprite = this.scene.add.sprite(0, 0);
            }

            get text() {
                return this._text;
            }
            set text(v) {
                this._text = v;
                
                if (this._dynamic) { this._dynamic.text = this._text; }
                
            }

            get style() {
                return this._style;
            }
            set style(v) {
                this._style = v;
            }

            get onSelect() {
                return this._onSelect;
            }
            set onSelect(v) {
                this._onSelect = v;
            }

            get width() {
                return this._width;
            }
            set width(v) {
                this._width = v;
                this._DOM.width = v;
            }

            get height() {
                return this._height;
            }
            set height(v) {
                this._height = v;
                this._DOM.height = v;
            }

            get x() {
                return this._x;
            }
            set x(v) {
                this._x = v;
                this._DOM.x = v;
            }

            get y() {
                return this._y;
            }
            set y(v) {
                this._y = v;
                this._DOM.y = v;
            }

            get visible() {
                return this._visible;
            }
            set visible(v) {
                this._visible = v;
                this._DOM.visible = v;
            }

            get stroke() {
                return this._stroke;
            }
            set stroke(v) {
                this._stroke = v;
                this._DOM.stroke = v;
            }

            get fill() {
                return this._fill;
            }
            set fill(v) {
                this._fill = v;
                this._DOM.fill = v;
            }

            set() {
                if (this._availableStyling[this.style]) {
                    this._availableStyling[this.style](this);
                }
            }

            size(w, h) {
                this._dynamic.width = w;
                this._dynamic.height = h;
            }
        }





        class PreloadScene extends Phaser.Scene {

            constructor (config) {
                super(config);
                console.log('Preload scene built.');
            }

            preload () {
            }

            create () {

                this.button = new MenuItem({
                    width: 100, height: 100,
                    x: 10, y: 100,
                    scene: this,
                    text: 'Hello there'
                });
                this.button.set();
                console.log(this.button);

            }

            update() {
              
            }
        }

        
    </script>

    <script>

        let width = 900;
        let height = 500;

        let GAME = new Phaser.Game({
            width,
            height,
            pixelArt: true,
            parent: 'parent'
        });

        GAME.scene.add('Preload', PreloadScene, true);

    </script>
</body>
