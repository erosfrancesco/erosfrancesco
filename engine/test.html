<head>
  	<title> Engine Headers </title>
</head>

<body>

    <style>
    
    #parent {
        display: table;
        margin: auto auto;
    }
  
    </style>
    <div id="parent"></div>

    <script src='../engine/phaser.min.js'></script>    
	<script src='../engine/colors.js'></script>
    <script src='../engine/input.js'></script>

    <script>

        class PreloadScene extends Phaser.Scene {

            constructor (config) {
                super(config);
                console.log('Preload scene built.');
            }

            preload () {
                this.load.setPath('../assets/');
                this.load.multiatlas('FFVICastSheet', 'ffviCast.json');
                //this.load.spritesheet('FFVICast2', ['ffviCast.png', 'ffviCast_n.png'], { frameWidth: 680 / 4, frameHeight: 756 / 4 });
                this.load.spritesheet('FFVICast', 'ffviCast.png', { frameWidth: 680 / 4, frameHeight: 756 / 4 });
            }

            create () {

                this.inputKeyb = new KeyInputMapper({scene: this, debounce: 8});
                this.inputKeyb.mapKey( Phaser.Input.Keyboard.KeyCodes.A, key => { console.log('selected'); });
                this.inputKeyb.mapKey( Phaser.Input.Keyboard.KeyCodes.S, key => { console.log('selected'); });
                //this.inputKeyb.removeKey(Phaser.Input.Keyboard.KeyCodes.S);


                // center origin
                let TerraSpriteConfig = {
                    key: 'FFVICast',
                    originX: 0.5,
                    originY: 0.5,
                    x: 0,
                    y: 0,
                    //scale: { randFloat: [ 0.2, 2 ] }
                };

                this.sprite = this.make.sprite(TerraSpriteConfig);
                this.sprite.x = 200;
                this.sprite.y = 200;




                this.capguy_anim = this.add.sprite(550, 300, 'FFVICastSheet', '02');
                 // switch on light
                this.capguy_anim.setPipeline('Light2D');
                
               

                var light  = this.lights.addLight(350, 250, 1000);
                this.lights.enable();
                this.lights.setAmbientColor(0x333355);
                /**/

                //this.sprite.setTint(window.colors.stringTo0x( window.colors.lime ));

                /*
                
                this.keyA = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A);

                let combo = this.input.keyboard.createCombo('phaser', { maxKeyDelay: 3000 });

                this.input.keyboard.on('keycombomatch', function (event) {
                    console.log('You typed phaser quickly!');
                });

                this.input.keyboard.on('keydown_B', function (event) {
                    console.log('hello a!');
                });
                /**/

// use mouse pointer to move light position
                this.input.on('pointermove', function (pointer) {
                    light.x = pointer.x;
                    light.y = pointer.y;
                });
            }

            update() {
                //if (Phaser.Input.Keyboard.JustDown(this.keyA)) console.log('Pooling a');
            
                this.inputKeyb.update();

            }
        }

        
    </script>

    <script>

        let width = 900;
        let height = 500;

        let GAME = new Phaser.Game({
            width,
            height,
            
            parent: 'parent'
        });

        GAME.scene.add('Preload', PreloadScene, true);

    </script>
</body>
